Première partie :  XML, DTD, XPath, XSLT

Etape 1 : Mise à jour de l'instance [XML, DTD]

1-1 Ajout balise <email>


Etape 2 : Exploration de l'instance [XPath]

1 - Les auteurs de la mise en forme :
/texte/entete/infos/mise_en_forme_par/auteur

2 - Les paragraphes de narration :
//paragr[@type="narration"]

3 - Les phrases en français :
 //phrase[@langue="fr"]

4 - La troisième phrase de chaque paragraphe :
//paragr/phrase[3]

5 - La neuvième phrase du texte :
//descendant-or-self::phrase[9]

6 - Les phrases commençant par "Je" :
//phrase[starts-with(text(),"Je")]

7 - Listez les types des paragraphes du texte :
//paragr[not(@type=preceding::paragr/@type)]/@type




Deuxième partie XQuery :

1. Retournez les phrases en français triés en ordre alphabétique :
<phrases>
{
  for $i in //phrase[@langue="fr"] order by $i
  return $i
}
</phrases>

2. Retournez les phrases françaises contenant le mot "mouton" :
<phrases> 
{
	for $i in //phrase[@langue="fr"] where contains($i,"mouton")
	return $i
}
</phrases>

3. Pour chaque paragraphe: donnez son type, le nombre de phrases qui la compose, les modalités de ces phrases (sans répétition) ainsi que les locuteurs :
<paragraphes>
{

	for $i in //paragr
	return <paragraphe type="{$i/@type}" nbphrase="{count($i/phrase)}">
  	{  
  		for $j in distinct-values($i/phrase/@modalite)
  		return <modalite> {$j} </modalite> 
  	}
  	{
  		for $k in $i/phrase/@locuteur
  		return <locuteur> {$k} </locuteur> 
  	}  
	</paragraphe>
}
</paragraphe>

4. Afficher la version française seulement (respectez la structure en paragraphes):
<texteFr>
{
  for $i in //paragr
  return <paragraphe>
  {
  for $j in $i/phrase[@langue="fr"]
    return $j (:  ou return data($j) pour avoir que le texte entre balises paragraphe :)

  }  
  </paragraphe>  
}
</texteFr>

5. Afficher uniquement les deuxièmes phrases des paragraphes de la version française :
<phrasesDeuxFr>
{
	for $i in //paragr/phrase[2][@langue="fr"]
	return $i
}
</phrasesDeuxFr>

6. Afficher seulement les dialogues en français du narrateur :
<dialogueFr>
{

	for $i in //paragr[@type="dialogue"]/phrase[@langue="fr"][@locuteur="Narrateur"]
	return $i
}
</dialogueFr>

7. Afficher toutes les phrases du Petit Prince en français qui comporte le mot "mouton" ainsi que le nombre de ces phrases :
<phrasesPP>
{

	for $c in //corps
	let $phrases := $c/paragr/phrase[@locuteur="LePetitPrince" and @langue="fr" and contains(.,"mouton")]

	return (
		<phrases> {$phrases} </phrases>,
		<nbPhrases>Le nombre de phrase est : {count($phrases)}</nbPhrases>
	)

}
</phrasesPP>



